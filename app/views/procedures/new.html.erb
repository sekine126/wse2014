<div class="title">
  <h1><strong>料理手順の登録</strong><small>＜料理の手順を入力＞</small></h1>
</div>

<div class="backbrown">
<%# valueの書き出し %>
<strong>使用食材:<br></strong>
<table class="table">
  <% @values.each do |value| %>
    <tr class="column">
      <td><%= @foods.find(value[:food_id]).name %> </td>
      <td>: <%= value[:value] %></td>
    </tr>
  <% end %>
</table>
<br>
<br>
<br>

<%# procedureの書き出し %>
<strong>手順:<br></strong>

<table class="table">

  <% if !params[:from_value] %>
    <% @procedures.each do |procedure| %>
      <tr class="column">
      <% if procedure[:sec] != "0" %>
        <td width="50px"><%= procedure[:number] %>:</td>
        <td><%= procedure[:detail] %></td>
        <td>: <%= procedure[:sec] %>秒 &nbsp;</td>
      <% else %>
        <td width="50px"><%= procedure[:number] %>:</td>
        <td><%= procedure[:detail] %></td>
        <td></td>
      <% end %>
      </tr>
    <% end %>
  <% end %>

  <%= form_tag ('/procedures/new') do %>
    <%# paramsで受け取ったprocedure,valueを遷移先でも保持 %>
    <% if !params[:from_value] %>
      <% @procedures.each do |procedure| %>
        <%= hidden_field_tag "procedure[][number]", procedure[:number] %>
        <%= hidden_field_tag "procedure[][detail]", procedure[:detail] %>
        <%= hidden_field_tag "procedure[][sec]", procedure[:sec] %>
      <% end %>
    <% end %>

    <% @values.each do |value| %>
      <%= hidden_field_tag "value[][value]", value[:value] %>
      <%= hidden_field_tag "value[][food_id]", value[:food_id] %>
      <%= hidden_field_tag "food_id", value[:food_id] %>
    <% end %>

      <tr class="column">
        <% if !params[:from_value] %>
          <td width="50px"><%= @procedures[-1]['number'].to_i + 1 %>:</td>
          <%= hidden_field_tag "procedure[][number]", @procedures[-1]['number'].to_i + 1 %>
        <% else %>
          <td width="50px">1:</td>
          <%= hidden_field_tag "procedure[][number]", 1 %>
        <% end %>
        <td><%= text_field_tag "procedure[][detail]"  %></td>
        <td><%= number_field_tag "procedure[][sec]", 0 %>秒</td>
      </tr>
      <tr>
        <td width="50px"></td>
        <td></td>
        <td class="add-btn">
          <p><button type="submit" class="btn btn-primary">追加</button></p>
        </td>
      </tr>
  <% end %>
</table>
</div><!-- backbrown -->

<%= form_tag ('/recipes/new') do %>
  <% if !params[:from_value] %>
    <% @procedures.each do |procedure| %>
      <% if procedure[:sec] != "0" %>
        <%= hidden_field_tag "procedure[][play]", true %>
      <% else %>
        <%= hidden_field_tag "procedure[][play]", false %>
      <% end %>
      <%= hidden_field_tag "procedure[][number]", procedure[:number] %>
      <%= hidden_field_tag "procedure[][detail]", procedure[:detail] %>
      <%= hidden_field_tag "procedure[][sec]", procedure[:sec] %>
    <% end %>
  <% end %>

  <% @values.each do |value| %>
    <%= hidden_field_tag "value[][value]", value[:value] %>
    <%= hidden_field_tag "value[][food_id]", value[:food_id] %>
  <% end %>
  <div class="next-btn">
    <p><button type="submit" class="btn btn-primary">次へ</button></p>
  </div>
<% end %>
